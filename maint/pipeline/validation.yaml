# Copyright (c) Microsoft Corporation.
# Licensed under the MIT License.

pr:
  - opensource
  - releases/*

pool:
  name : NNFusion Build Agents
  demands : gpu

stages:
- stage: Build
  jobs:
  - job: BuildJob
    steps:
    - script: ./maint/script/test.sh
  - job: Clean
    dependsOn: BuildJob
    condition: failed()
    steps:
    - script: ./maint/script/remove_all.sh
